var app = angular.module("FireFoxMarket", [ "ui.router" ]);

app.config(function($stateProvider, $urlRouterProvider) {
    $urlRouterProvider.otherwise("/"), $stateProvider.state("home", {
        url: "/",
        templateUrl: "/templates/home.html"
    });
}), app.controller("main", function() {}), app.factory("API", [ "Utils", function(Utils) {
    function format(s, args) {
        if (!s) throw "Format string is empty!";
        if (args) return args instanceof Array || args instanceof Object || (args = Array.prototype.slice.call(arguments, 1)), 
        s.replace(re, function(_, match) {
            return args[match];
        });
    }
    function template(s) {
        if (!s) throw "Template string is empty!";
        return function(args) {
            return format(s, args);
        };
    }
    var re = /\{([^}]+)\}/g;
    return {
        format: format,
        template: template
    };
} ]), app.factory("keys", function() {
    return {
        SHIFT: 16,
        CONTROL: 17,
        ALT: 18,
        PAUSE: 19,
        CAPS_LOCK: 20,
        ESCAPE: 27,
        ENTER: 13,
        PAGE_UP: 33,
        PAGE_DOWN: 34,
        LEFT: 37,
        UP: 38,
        RIGHT: 39,
        DOWN: 40,
        HOME: 36,
        END: 35,
        COMMAND: 91,
        WINDOWS_RIGHT: 92,
        COMMAND_RIGHT: 93,
        WINDOWS_LEFT_OPERA: 219,
        WINDOWS_RIGHT_OPERA: 220,
        APPLE: 24
    };
}), app.factory("Market", [ "$http", "API", function() {} ]), app.factory("Utils", function() {
    function baseurl(url) {
        return url.split("?")[0];
    }
    function encodeURIComponent(uri) {
        return window.encodeURIComponent(uri).replace(/%20/g, "+");
    }
    function decodeURIComponent(uri) {
        return window.decodeURIComponent(uri.replace(/\+/g, " "));
    }
    function urlparams(url, kwargs) {
        return baseurl(url) + "?" + urlencode(_.defaults(kwargs, querystring(url)));
    }
    return {
        baseurl: baseurl,
        encodeURIComponent: encodeURIComponent,
        decodeURIComponent: decodeURIComponent,
        urlparams: urlparams
    };
}), app.controller("myapps", function() {
    navigator.mozApps.getInstalled();
}), app.controller("home", [ "API", function() {} ]);